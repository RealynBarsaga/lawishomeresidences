RewriteEngine On
RewriteBase /admin

# Block direct access to login.php
RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /admin/\ HTTP/
RewriteRule ^login\.php$ - [F,L]

# Allow access to login.php through /admin
RewriteRule ^$ login.php [L]