RewriteEngine On
RewriteBase /admin

# Remove trailing slash from /admin/
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} ^(.+)/$
RewriteRule ^ %1 [R=301,L]

# Block direct access to login.php
RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /admin/\ HTTP/
RewriteRule ^login\.php$ - [F,L]

# Allow access to login.php through /admin
RewriteRule ^$ login.php [L]


RewriteEngine On
RewriteCond %{THE_REQUEST} \s/forgot_password\.php\?pages=forgot_password[\s?] [NC]
RewriteRule ^forgot_password\.php$ - [F]