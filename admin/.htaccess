RewriteEngine On
RewriteBase /admin

# Remove trailing slash from /admin/
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} ^(.+)/$
RewriteRule ^ %1 [R=301,L]

# Block direct access to login.php
RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /admin/login\.php\ HTTP/
RewriteRule ^login\.php$ - [F,L]

# Allow access to login.php through /admin
RewriteRule ^$ login.php [L]